name: "readout"
defaults:
  roc_ctp_emulator_enabled: "true"
roles:
  - name: "host-{{ it }}"
    for:
      range: "{{ hosts }}"
      var: it
    constraints:
      - attribute: machine_id
        value: "{{ it }}"
    roles:
      - name: "readout"
        task:
          load: readout
      - name: roc-ctp-emulators
        enabled: "{{roc_ctp_emulator_enabled}}"
        defaults:
          roc_ctp_emulator_endpoints: '["#0"]'
        roles:
          - name: roc-ctp-emulator-{{ endpoint_id }}
            for:
              range: "{{roc_ctp_emulator_endpoints}}"
              var: endpoint_id
            task:
              load: "roc-ctp-emulator"
              trigger: "enter_RUNNING"
              timeout: 10s
              critical: false

