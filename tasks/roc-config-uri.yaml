name: roc-config-uri
control:
  mode: basic
wants:
  cpu: 0.2
  memory: 256
defaults:
  rocConfigBypassFwCheck: "false"
  rocConfigForceConfig: "false"
  log_task_output: none
command:
  env:
    - O2_INFOLOGGER_MODE={{ infologger_mode }}
  log: "{{ log_task_output }}"
  shell: true
  value: >-
    source /etc/profile.d/modules.sh &&
    MODULEPATH={{ modulepath }} module load ReadoutCard &&
    o2-roc-config
  arguments:
    - "--id"
    - "{{ rocConfigId }}"
    - "--config-uri"
    - "{{ rocConfigConfigUri }}"
    - "{{ rocConfigBypassFwCheck  == 'true' ? '--bypass-fw-check' : ''}}"
    - "{{ rocConfigForceConfig == 'true' ? '--force-config' : '' }}"
